<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>贷款申请</title>
	<link href="css/mui.css" rel="stylesheet" type="text/css" media="all">
	<link href="css/reset.css" rel="stylesheet" type="text/css" media="all">
	<link href="css/input.css" rel="stylesheet" type="text/css" media="all">
	<link href="css/brand.css" rel="stylesheet" type="text/css" media="all">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>
<body>
	<header>
		<div class="head-title">贷款申请</div>
	</header>
	<div class="main">
		<nav class="mui-bar mui-bar-tab top-bar">
			<a class="mui-active loan-information-tab">
				<span class="mui-tab-label">贷款信息</span>
			</a>
			<a class="car-info-tab">
				<span class="mui-tab-label">车辆信息</span>
			</a>
		</nav>
		<div class="mui-content">
			<div id="loan-information" class="mui-control-content mui-active">
				<div class="mui-input-row">
					<label>借款人姓名</label>
					<input class="name" placeholder="借款人姓名" maxlength="15" type="text">
				</div>
				<div class="mui-input-row">
					<label>所在城市</label>
					<input class="city" id='showCityPicker' readonly="true" placeholder="选择所在城市" type="text">
					<input id="cityId" name="cityId" type="hidden">
				</div>
				<div class="mui-input-row rmb">
					<label>贷款金额</label>
					<input class="input-rmbnum" placeholder="贷款金额" type="number">
					<span>万元</span>
				</div>
				<div class="mui-input-row phone">
					<label>手机号码</label>
					<input class="phone-num" placeholder="输入手机号码" type="number" maxlength="11">
					<button class="send-code" onclick="sendCode('02')">发送验证码</button>
				</div>
				<div class="mui-input-row">
					<label>短信验证码</label>
					<input class="phone-code" placeholder="输入短信验证码" type="text">
				</div>
				<div class="mui-input-row">
					<label>推荐码</label>
					<input class="refrral-code" placeholder="输入推荐码" type="text">
				</div>
				<button class="sub-btn" onclick="subData('02')">下一步</button>
			</div>
			<div id="car-info" class="mui-control-content">
				<form name="carInfoForm" id="carInfoForm" method="post" enctype="multipart/form-data">
					<div class="mui-input-row">
						<label>车品牌</label>
						<input class="car-brand" id="carBrand" name='carBrand' placeholder="选择汽车品牌及型号" readonly="true" type="text">
						<input id="carId" name="carId" type="hidden">
					</div>
					<div class="mui-input-row">
						<label>车型号</label>
						<input class="car-model" placeholder="" disabled="true" type="text" disabled="true">
						<input id="carModelId" name="carSubTypeId" type="hidden">
					</div>
					<div class="mui-input-row">
						<label>行驶证</label>
						<input type="file" id="file0" name="xs" accept="image/*" /> 
						<!-- <input type="file" id="file0" name="xs" accept="image/*" onchange="selectFileImage(this);" />  -->
					</div>
					<div class="mui-input-row">
						<label>车辆登记证</label>
						<input type="file" id="file1" name='dj' accept="image/*" /> 
						<!-- <input type="file" id="file1" name='dj' accept="image/*" onchange="selectFileImage(this);" />  -->
					</div>
					<div class="mui-input-row">
						<label>车辆大本</label>
						<input type="file" id="file1" name="cl" accept="image/*" /> 
						<!-- <input type="file" id="file1" name="cl" accept="image/*" onchange="selectFileImage(this);" />  -->
					</div>
					<input id="orderNo" type="hidden" name="orderNo" value="">
					<img id="myImage">
					<!-- <button class="sub-btn" onclick="subData('021')">提交</button> -->
				</form>
					<button class="sub-btn" onclick="subData('021')">提交</button>
			</div>
		</div>
		<!-- 选择品牌 -->
		<div class="brand popup">
			<div class="close">
				<span></span>
			</div>
			<div class="brand-nav">
				<a href="javascript:;" onclick="javascript:document.getElementById('hot').scrollIntoView()">热</a>
			</div>
			<div class="brand-list">
				<!-- 热门品牌 -->
				<div class="hot">
					<div class="title" id="hot">热门品牌</div>
					<div class="mui-row">
						
					</div>
				</div>
				<!-- end -->
			</div>
		</div>
		<!-- 选择品牌下的车型 -->
		<div class="child-brand popup"></div>
		<!-- 页尾提示栏 -->
		<div class="footer-bar">—— 我也是有底线的 ——</div>
	</div>
	<footer>
		<!-- 底部导航栏 -->
		<div class="footer-nav mui-row">
			<!-- 首页 -->
			<div class="mui-col-xs-6 home">
				<a href="index.html">
					<i></i>
					<p>首页</p>
				</a>
			</div>
			<!-- 贷款 -->
			<div class="mui-col-xs-6 loans active">
				<a href="javascript:;">
					<i></i>
					<p>贷款</p>
				</a>
			</div>
		</div>
	</footer>
</body>
<script type="text/javascript" src="js/setWidth.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/mui.js"></script>
<script type="text/javascript" src="js/mui.picker.js"></script>
<script type="text/javascript" src="js/mui.poppicker.js"></script>
<script type="text/javascript" src="js/jquery.form.js"></script>
<script type="text/javascript" src="js/custom.js"></script>
<!-- <script type="text/javascript" src="js/exif.js"></script> -->
<script type="text/javascript">
	start(true,false,false,true);
</script>
<!-- <script type="text/javascript">
	function selectFileImage(fileObj) { 
	    var file = fileObj.files['0']; 
	    //图片方向角 added by lzk 
	    var Orientation = null; 
	     
	    if (file) { 
	        console.log("正在上传,请稍后..."); 
	        var rFilter = /^(image\/jpeg|image\/png)$/i; // 检查图片格式 
	        if (!rFilter.test(file.type)) { 
	            //showMyTips("请选择jpeg、png格式的图片", false); 
	            return; 
	        } 
	        // var URL = URL || webkitURL; 
	        //获取照片方向角属性，用户旋转控制 
	        EXIF.getData(file, function() { 
	           // alert(EXIF.pretty(this)); 
	            EXIF.getAllTags(this);  
	            //alert(EXIF.getTag(this, 'Orientation'));  
	            Orientation = EXIF.getTag(this, 'Orientation'); 
	            //return; 
	        }); 
	         
	        var oReader = new FileReader(); 
	        oReader.onload = function(e) { 
	            //var blob = URL.createObjectURL(file); 
	            //_compress(blob, file, basePath); 
	            var image = new Image(); 
	            image.src = e.target.result; 
	            image.onload = function() { 
	                var expectWidth = this.naturalWidth; 
	                var expectHeight = this.naturalHeight; 
	                 
	                if (this.naturalWidth > this.naturalHeight && this.naturalWidth > 800) { 
	                    expectWidth = 800; 
	                    expectHeight = expectWidth * this.naturalHeight / this.naturalWidth; 
	                } else if (this.naturalHeight > this.naturalWidth && this.naturalHeight > 1200) { 
	                    expectHeight = 1200; 
	                    expectWidth = expectHeight * this.naturalWidth / this.naturalHeight; 
	                } 
	                var canvas = document.createElement("canvas"); 
	                var ctx = canvas.getContext("2d"); 
	                canvas.width = expectWidth; 
	                canvas.height = expectHeight; 
	                ctx.drawImage(this, 0, 0, expectWidth, expectHeight); 
	                var base64 = null; 
	                //修复ios 
	                if (navigator.userAgent.match(/iphone/i)) { 
	                    console.log('iphone'); 
	                    //alert(expectWidth + ',' + expectHeight); 
	                    //如果方向角不为1，都需要进行旋转 added by lzk 
	                    if(Orientation != "" && Orientation != 1){
	                    	alert(Orientation);
	                        switch(Orientation){ 
	                            case 6://需要顺时针（向左）90度旋转 
	                                alert('需要顺时针（向左）90度旋转'); 
	                                rotateImg(this,'left',canvas); 
	                                alert('需要顺时针（向左）90度旋转');
	                                rotateImg(this,'left',canvas); 
	                                break; 
	                            case 8://需要逆时针（向右）90度旋转 
	                                alert('需要顺时针（向右）90度旋转'); 
	                                rotateImg(this,'right',canvas); 
	                                break; 
	                            case 3://需要180度旋转 
	                                alert('需要180度旋转'); 
	                                rotateImg(this,'right',canvas);//转两次 
	                                rotateImg(this,'right',canvas); 
	                                break; 
	                        }        
	                    } 
	                     
	                    /*var mpImg = new MegaPixImage(image); 
	                    mpImg.render(canvas, { 
	                        maxWidth: 800, 
	                        maxHeight: 1200, 
	                        quality: 0.8, 
	                        orientation: 8 
	                    });*/ 
	                    base64 = canvas.toDataURL("image/jpeg", 0.8); 
	                }else if (navigator.userAgent.match(/Android/i)) {// 修复android 
	                    var encoder = new JPEGEncoder(); 
	                    base64 = encoder.encode(ctx.getImageData(0, 0, expectWidth, expectHeight), 80); 
	                }else{ 
	                    //alert(Orientation); 
	                    if(Orientation != "" && Orientation != 1){
	                        switch(Orientation){ 
	                            case 6://需要顺时针（向左）90度旋转 
	                                alert('需要顺时针（向左）90度旋转'); 
	                                rotateImg(this,'left',canvas); 
	                                break; 
	                            case 8://需要逆时针（向右）90度旋转 
	                                alert('需要顺时针（向右）90度旋转'); 
	                                rotateImg(this,'right',canvas); 
	                                break; 
	                            case 3://需要180度旋转 
	                                alert('需要180度旋转'); 
	                                rotateImg(this,'right',canvas);//转两次 
	                                rotateImg(this,'right',canvas); 
	                                break; 
	                        }        
	                    } 
	                     
	                    base64 = canvas.toDataURL("image/jpeg", 0.8); 
	                } 
	                //uploadImage(base64); 
	                $("#myImage").attr("src", base64); 
	            }; 
	        }; 
	        oReader.readAsDataURL(file); 
	    } 
	} 
 
	//对图片旋转处理 added by lzk www.bcty365.com 
	function rotateImg(img, direction,canvas) {   
        //alert(img); 
        //最小与最大旋转方向，图片旋转4次后回到原方向   
        var min_step = 0;   
        var max_step = 3;   
        //var img = document.getElementById(pid);   
        if (img == null)return;   
        //img的高度和宽度不能在img元素隐藏后获取，否则会出错   
        var height = img.height;   
        var width = img.width;   
        //var step = img.getAttribute('step');   
        var step = 2;   
        if (step == null) {   
            step = min_step;   
        }   
        if (direction == 'right') {   
            step++;   
            //旋转到原位置，即超过最大值   
            step > max_step && (step = min_step);   
        } else {   
            step--;   
            step < min_step && (step = max_step);   
        }   
        //img.setAttribute('step', step);   
        /*var canvas = document.getElementById('pic_' + pid);   
        if (canvas == null) {   
            img.style.display = 'none';   
            canvas = document.createElement('canvas');   
            canvas.setAttribute('id', 'pic_' + pid);   
            img.parentNode.appendChild(canvas);   
        }  */ 
        //旋转角度以弧度值为参数   
        var degree = step * 90 * Math.PI / 180;   
        var ctx = canvas.getContext('2d');   
        switch (step) {   
            case 0:   
                canvas.width = width;   
                canvas.height = height;   
                ctx.drawImage(img, 0, 0);   
                break;   
            case 1:   
                canvas.width = height;   
                canvas.height = width;   
                ctx.rotate(degree);   
                ctx.drawImage(img, 0, -height);   
                break;   
            case 2:   
                canvas.width = width;   
                canvas.height = height;   
                ctx.rotate(degree);   
                ctx.drawImage(img, -width, -height);   
                break;   
            case 3:   
                canvas.width = height;   
                canvas.height = width;   
                ctx.rotate(degree);   
                ctx.drawImage(img, -width, 0);   
                break;   
        }   
    }   
</script> -->
</html>