<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>贷款</title>
	<link rel="stylesheet" href="css/layout.css">
	<link rel="stylesheet" href="css/loan.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black"> 
</head>
<body id="loca-ddk">
	<div class="input">
		<div class="inputName">姓名:</div>
		<input type="text" name="name" placeholder="姓名">
	</div>
	<div class="input">
		<div class="inputName">身份证号:</div>
		<input type="text" name="cardNum" placeholder="身份证号">
	</div>
	<div class="input">
		<div class="inputName">手机号码:</div>
		<input type="text" name="phoneNum" placeholder="手机号码">
	</div>
	<button class="submit">提交</button>
</body>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/setWidth.js"></script>
<script type="text/javascript">
// 验证身份证
function isCardNo(IDCard){
	var pattern= /(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}[0-9Xx]$)/;
 	return pattern.test(IDCard); 
}
// 验证手机号
function isPhoneNo(phone) { 
 var pattern = /^1[34578]\d{9}$/; 
 return pattern.test(phone); 
}
//截取url
function getQueryString(name) {  
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");  
    var r = window.location.search.substr(1).match(reg);  
    if (r != null) return unescape(r[2]);  
    return null;  
} 
var innerCode=getQueryString("innerCode");
console.log(innerCode);
$(".submit").click(function(){
	if($("input[name='name']").val().length=='0'){
		layer.open({
		    content: '姓名不能为空！'
		    ,skin: 'msg'
		    ,time: 2 //2秒后自动关闭
	  	});	
	  	return;
	}else if($("input[name='cardNum']").val().length=='0'){
		layer.open({
		    content: '身份证号不能为空！'
		    ,skin: 'msg'
		    ,time: 2 //2秒后自动关闭
	  	});	
	  	return;
	}else if(isCardNo($("input[name='cardNum']").val())==false){
		layer.open({
		    content: '身份证号输入错误！'
		    ,skin: 'msg'
		    ,time: 2 //2秒后自动关闭
	  	});	
	  	return;
	}else if($("input[name='phoneNum']").val().length=='0'){
		layer.open({
	    content: '手机号码不能为空！'
	    ,skin: 'msg'
	    ,time: 2 //2秒后自动关闭
		});	
		return;
	}else if(isPhoneNo($("input[name='phoneNum']").val())==false){
		layer.open({
	    content: '手机号码格式错误！'
	    ,skin: 'msg'
	    ,time: 2 //2秒后自动关闭
		});	
		return;
	}else{
		$.post("../mobile/act/addLoanApplyUser",
	    {
	      userName : $("input[name='name']").val(),
	      cardNum: $("input[name='cardNum']").val() ,
	      contactNum: $("input[name='phoneNum']").val() ,
	      innerCode : innerCode
	    },
	    function(data,status){
	    	console.log(data);
	    	if(data.success==true){
	    	// 	layer.open({
				  //   content: '提交成功！正在跳转'
				  //   ,skin: 'msg'
				  //   ,time: 2 //2秒后自动关闭
			  	// });	
			  	// setTimeout(function(){
					window.location.href="finamarket/ddk_page.html";
			  	// },2000)
	    	}else{
	    		layer.open({
				    content: '网络异常，请稍候再试！'
				    ,skin: 'msg'
				    ,time: 2 //2秒后自动关闭
			  	});	
	    	}
	      // alert("数据：" + data + "\n状态：" + status);
	    });
	}
})
</script>
</html>