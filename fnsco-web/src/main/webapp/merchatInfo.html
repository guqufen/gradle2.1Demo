<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商户信息-法奈昇大数据平台</title>
    <meta name="keywords" content="法奈昇大数据平台">
    <meta name="description" content="法奈昇大数据平台">
    <link rel="shortcut icon" href="favicon.ico">
    <link href="js/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="js/bootstrap/css/font-awesome.css" rel="stylesheet">
    <link href="css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link href="css/style.min.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <link href="js/uploadify-v3.1/uploadify.css">
</head>
<body class="gray-bg">
<div class="panel-body animated fadeInRight">
    <div class="panel panel-default">
        <form id="formSearch" class="form-horizontal">
            <div class="form-group" style="margin-top:15px">
                <div class="row col-sm-10">
                    <div class="col-sm-4">
                        <label class="control-label" for="txt_search_id">手机号码：</label>
                        <input type="text" class="form-control" id="txt_search_id">
                    </div>
                    <div class="col-sm-4">
                        <label class="control-label" for="txt_search_name">商户号：</label>
                        <input type="text" class="form-control" id="txt_search_name">
                    </div>
                    <div class="col-sm-4">
                        <label class="control-label" for="txt_search_price">交易金额：</label>
                        <input type="text" class="form-control" id="txt_search_price">
                    </div>
                    <div class="col-sm-4">
                        <label class="control-label" for="txt_search_price">交易金额：</label>
                        <input type="text" class="form-control" id="txt_search_price">
                    </div>
                </div>
                <div class="col-sm-2" style="text-align: right;">
                    <button type="button" id="btn_query" class="btn btn-primary" onclick="javascript:queryEvent();"><span class="glyphicon glyphicon-search"></span>查询</button>
                    <button type="button" id="btn_reset" class="btn btn-default" onclick="javascript:resetEvent();"><span class="glyphicon glyphicon-refresh"></span>重置</button>
                </div>
            </div>

        </form>
        <!-- start -->
        <div class="ibox float-e-margins">
            <div class="ibox-content">
                <div class="row row-lg">
                    <div class="col-sm-12">
                        <div id="toolbar">
                            <button id="btn_add" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
                            </button>
                            <button id="btn_delete" type="button" class="btn btn-danger">
                                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>批量删除
                            </button>
                        </div>
                        <table id="table" style="width:2400px"></table>
                    </div>
                </div>
            </div>
        </div>
        <!-- end  -->
        <!-- model start -->
        <form action="/web/merchantinfo/toAdd" id="merchant_form" method="post">
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static" data-keyboard="false">
		    <div class="modal-dialog" role="document">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		                <h4 class="modal-title" id="myModalLabel">新增商户</h4>
		            </div>
		            <div class="modal-body">
		                <ul class="nav nav-tabs" role="tablist">
		                    <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">基本信息</a></li>
		                    <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">资质文件</a></li>
		                    <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">联系信息</a></li>
		                    <li role="presentation"><a href="#terminal_info" aria-controls="terminal_info" role="tab" data-toggle="tab">终端信息</a></li>
		                    <li role="presentation"><a href="#channel_info" aria-controls="channel_info" role="tab" data-toggle="tab">渠道信息</a></li>
		                </ul>
		                <div class="tab-content">
		                    <div role="tabpanel" class="tab-pane active" id="home">
		                        <div class="row">
		                            <div class="col-sm-4">
		                                <label class="control-label" for="name">商户名：</label>
		                                <input type="text" class="form-control" id="name" name="name" required="required">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="abbreviation">简称：</label>
		                                <input type="text" class="form-control" id="abbreviation" name="abbreviation">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="enName">商户名英文名：</label>
		                                <input type="text" class="form-control" id="enName" name="enName">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="legalPerson">商户法人姓名：</label>
		                                <input type="text" class="form-control" id="legalPerson" name="legalPerson">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="legalPersonMobile">法人手机号码：</label>
		                                <input type="number" class="form-control" id="legalPersonMobile" name="legalPersonMobile" >
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="legalPersonTel">法人电话：</label>
		                                <input type="text" class="form-control" id="legalPersonTel" name="legalPersonTel">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label " for="legalValidCardType">法人有效证件类型：</label>
		                                <select id="legalValidCardType" name="legalValidCardType" class="form-control">
		                                   <option value="0">身份证</option>
		                                   <option value="1">护照</option>
		                                   <option value="2">士兵证</option>
		                                   <option value="3">军官证</option>
		                                   <option value="4">港澳台通行证</option>
		                                </select>
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="cardNum">证件号码：</label>
		                                <input type="text" class="form-control" id="cardNum" name="cardNum">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="cardValidTime">证件有效期：</label>
		                                <input type="date" class="form-control" id="cardValidTime" name="cardValidTime">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="businessLicenseNum">营业执照号码：</label>
		                                <input type="text" class="form-control" id="businessLicenseNum" name="businessLicenseNum">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="businessLicenseValidTime">营业执照有效期：</label>
		                                <input type="date" class="form-control" id="businessLicenseValidTime" name="businessLicenseValidTime">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="taxRegistCode">税务登记号：</label>
		                                <input type="text" class="form-control" id="taxRegistCode" name="taxRegistCode">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="registAddress">商户注册地址：</label>
		                                <input type="text" class="form-control" id="registAddress" name="registAddress">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="mercFlag">商户标签：</label>
		                                <input type="text" class="form-control" id="mercFlag" name="mercFlag">
		                            </div>
		                        </div>
		                        <a class="nextBtn" href="#profile" aria-controls="profile" role="tab" data-toggle="tab">下一步</a>
		                    </div>
		                    <div role="tabpanel" class="tab-pane" id="profile">
		                    <table class="table table-bordered">
		                      	<thead>
		                          	<th style="width: 30%">材料名称</th>
		                          	<th style="width: 40%">文件名</th>
		                          	<th style="width: 30%">操作</th>
		                      	</thead>
		                      	<tr>
		                          	<td>银行卡正面</td>
		                          	<td><div id="view1100"></div><div id="fileQueue1100"></div></td>
		                          	<td>
		                          		<input type="file" name="file" id="uploadify_file1100" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first1100" onclick="fileUp(1100);" style="display: none;"/>                          
		                          	</td>
		                      	</tr>
		                      	<tr>
									<td>银行卡反面</td>
									<td><div id="view1101"></div><div id="fileQueue1101"></div></td>
									<td>
		                          	<input type="file" name="file" id="uploadify_file1101" style="display: none">
		                          	<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first1101" onclick="fileUp(1101);" style="display: none"/>
		                          </td>
		                      	</tr>
		                      	<tr>
		                          	<td>手持身份证、银行卡</td>
		                          	<td><div id="view1190"></div><div id="fileQueue1190"></div></td>
		                          	<td>
		                           		<input type="file" name="file" id="uploadify_file1190" style="display: none">
		                           		<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first1190" onclick="fileUp(1190);" style="display: none"/>
		                          	</td>
		                      	</tr>
		                      	<tr>
		                          	<td>营业执照</td>
		                          	<td><div id="view1"></div><div id="fileQueue1"></div></td>
		                          	<td>
		                          		<input type="file" name="file" id="uploadify_file1" style="display: none" />
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first1" onclick="fileUp(1);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>签约协议照片</td>
		                          <td><div id="view2"></div><div id="fileQueue2"></div></td>
		                          <td>
		                        		<input type="file" name="file" id="uploadify_file2" style="display: none" />
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first2" onclick="fileUp(2);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>入账人身份证正面</td>
		                          <td><div id="view300"></div><div id="fileQueue300"></div></td>
		                          <td>
		                          	<input type="file" name="file" id="uploadify_file300" style="display: none" >
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first300" onclick="fileUp(300);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>入账人身份证反面</td>
		                          <td><div id="view301"></div><div id="fileQueue301"></div></td>
		                          <td>
			                          	<input type="file" name="file" id="uploadify_file301" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first301" onclick="fileUp(301);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>房屋租赁合同照片</td>
		                          <td><div id="view4"></div><div id="fileQueue4"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file4" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first4" onclick="fileUp(4);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>法人身份证照片</td>
		                          <td><div id="view6"></div><div id="fileQueue6"></div></td>
		                          <td>
		                          <input type="file" name="file" id="uploadify_file6" style="display: none" >
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first6" onclick="fileUp(6);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>商户信息登记表照片</td>
		                          <td><div id="view7"></div><div id="fileQueue7"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file7" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first7" onclick="fileUp(7);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>组织机构代码证照片</td>
		                          <td><div id="view8"></div><div id="fileQueue8"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file8" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first8" onclick="fileUp(8);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>店面外景</td>
		                          <td><div id="view900"></div><div id="fileQueue900"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file900" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first900" onclick="fileUp(900);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>店面内景</td>
		                          <td><div id="view901"></div><div id="fileQueue901"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file901" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first901" onclick="fileUp(901);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>收银台照</td>
		                          <td><div id="view902"></div><div id="fileQueue902"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file902" style="display: none" >
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first902" onclick="fileUp(902);" style="display: none"/>
		                          </td>
		                      </tr>
		                      <tr>
		                          <td>税务登记证照片</td>
		                          <td><div id="view10"></div><div id="fileQueue10"></div></td>
		                          <td><input type="file" name="file" id="uploadify_file10" style="display: none">
										<input type="button"  name='init' class="btn" value="开始上传" id="fileupload_button_first10" onclick="fileUp(10);" style="display: none"/>
		                          </td>
		                      </tr>
		                    </table>
		                        <a class="nextBtn"  href="#messages" aria-controls="messages" role="tab" data-toggle="tab">下一步</a>
		                    </div>
		                    <div role="tabpanel" class="tab-pane" id="messages">
		                        <div class="row">
		                            <div class="col-sm-4">
		                                <label class="control-label" for="contactName">联系人名：</label>
		                                <input type="text" class="form-control" id="contactName" name="contactName">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="contactMobile">联系人手机：</label>
		                                <input type="number" class="form-control" id="contactMobile" name="contactMobile">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="contactEmail">联系人邮箱：</label>
		                                <input type="email" class="form-control" id="contactEmail" name="contactEmail">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="contactTelphone">电话：</label>
		                                <input type="text" class="form-control" id="contactTelphone" name="contactTelphone">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="contactJobs">职位：</label>
		                                <input type="text" class="form-control" id="contactJobs" name="contactJobs">
		                            </div>
		                        </div>
		                        <a class="nextBtn" href="#terminal_info" aria-controls="terminal_info" role="tab" data-toggle="tab">下一步</a>
		                    </div>
		                    <!-- 终端信息 -->
		                    <div role="tabpanel" class="tab-pane" id="terminal_info">
		                        <div class="row">
		                            <div class="col-sm-4">
		                                <label class="control-label" for="merchantCode">通道商户号：</label>
		                                <input type="text" class="form-control" id="merchantCode" name="merchantCode" required="required">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="channelId">通道ID：</label>
		                                <input type="number" class="form-control" id="channelId" name="channelId">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="channelName">通道名称：</label>
		                                <input type="text" class="form-control" id="channelName" name="channelName">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="terminalCode">通道终端号：</label>
		                                <input type="text" class="form-control" id="terminalCode" name="terminalCode">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="innerTermCode">内部终端号 10000000：</label>
		                                <input type="text" class="form-control" id="innerTermCode" name="innerTermCode">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="snCode">POS机SN码：</label>
		                                <input type="text" class="form-control" id="snCode" name="snCode">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="terminalBatch">终端批次号：</label>
		                                <input type="text" class="form-control" id="terminalBatch" name="terminalBatch">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="terminalPara">终端参数：</label>
		                                <input type="text" class="form-control" id="terminalPara" name="terminalPara">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="chargesType">收费类型：</label>
		                                <select name="chargesType" class="form-control">
		                                	<option value="1">按每笔百分比</option>
		                                	<option value="2">按每笔固定金额</option>
		                                	<option value="3">百分比封顶</option>
		                                </select>
<!-- 		                                <input type="text" class="form-control" id="chargesType" name="chargesType"> -->
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="debitCardRate">借记卡费率：</label>
		                                <input type="text" class="form-control" id="debitCardRate" name="debitCardRate">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="creditCardRate">贷记卡费率：</label>
		                                <input type="text" class="form-control" id="creditCardRate" name="creditCardRate">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="debitCardFee">借记卡固定金额：</label>
		                                <input type="number" class="form-control" id="debitCardFee" name="debitCardFee">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="creditCardFee">贷记卡固定金额：</label>
		                                <input type="number" class="form-control" id=creditCardFee name="creditCardFee">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="debitCardMaxFee">借记卡费率封顶值：</label>
		                                <input type="number" class="form-control" id="debitCardMaxFee" name="debitCardMaxFee">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="creditCardMaxFee">贷记卡费率封顶值：</label>
		                                <input type="number" class="form-control" id="creditCardMaxFee" name="creditCardMaxFee">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="dealSwitch">交易设置：</label>
		                                <input type="text" class="form-control" id="dealSwitch" name="dealSwitch">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="recordState">记录状态：</label>
		                                <select name="recordState" class="form-control">
		                                  <option value="0">初始化状态</option>
		                                  <option value="1">已绑定渠道商户</option>
		                                  <option value="4">停用</option>
		                                </select>
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="termAuditState">终端审核状态：</label>
		                                <select name="termAuditState" class="form-control">
		                                  <option value="0">初始化状态</option>
		                                  <option value="1">已绑定渠道商户</option>
		                                  <option value="4">停用</option>
		                                </select>
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="termName">终端名称：</label>
		                                <input type="text" class="form-control" id="termName" name="termName">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="posFactory">机具厂家：</label>
		                                <input type="text" class="form-control" id="posFactory" name="posFactory">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="posType">机具型号：</label>
		                                <input type="text" class="form-control" id="posType" name="posType">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="mercReferName">签购单参考名：</label>
		                                <input type="text" class="form-control" id="mercReferName" name="mercReferName">
		                            </div>
		                        </div>
		                        <a class="nextBtn" href="#channel_info" aria-controls="channel_info" role="tab" data-toggle="tab">下一步</a>
		                    </div>
		                    <div role="tabpanel" class="tab-pane" id="channel_info">
		                        <div class="row">
		                            <div class="col-sm-4">
		                                <label class="control-label" for="agentId">代理商：</label>
		                                <input type="number" class="form-control" id="agentId" name="agentId" required="required">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="channelMerId">渠道商户号：</label>
		                                <input type="text" class="form-control" id="channelMerId" name="channelMerId">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="channelMerKey">渠道商户key：</label>
		                                <input type="text" class="form-control" id="channelMerKey" name="channelMerKey">
		                            </div>
		                            <div class="col-sm-4">
		                                <label class="control-label" for="channelType">渠道类型：</label>
		                                  <select name="channelType" class="form-control">
		                                  <option value="00">爱农</option>
		                                  <option value="01">浦发</option>
		                                  <option value="02">拉卡拉</option>
		                                </select>
		                            </div>
		                        </div>
		                         <a class="saveBtn" id="save_btn" type="submit">保存</a>
		                    </div>
		                </div>
		            </div>
		            <input type="hidden" id="innoCode" name="innerCode">
		            <!-- <div class="modal-footer">
		                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		                <button type="button" class="btn btn-primary">Save changes</button>
		            </div> -->
		        </div>
		    </div>
		</div>
		</form>
		<!-- model end -->
    </div> 
    
</div>
<script src="https://cdn.staticfile.org/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<!-- <script src="js/content.min.js"></script> -->
<script src="js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
<script src="js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
<script src="js/plugins/bootstrap-table/bootstrap-table-export.js"></script>
<script src="js/plugins/bootstrap-table/tableExport.js"></script>
<script src="js/plugins/bootstrap-table/tableExport.js"></script>
<script src="js/plugins/bootstrap-table/bootstrap-table-editable.js"></script>
<script src="js/plugins/bootstrap-table/bootstrap-editable.js"></script>
<script src="js/plugins/bootstrap-table/bootstrap-table-zh-CN.min.js"></script>
<script src="js/uploadify-v3.1/jquery.uploadify.js"></script>
</body>
<script type="text/javascript">
	initTableData();
    window.operateEvents = {
        'click .redact': function (e, value, row, index) {
            alert('You click like action, row: ' + JSON.stringify(row));
        },
        'click .remove': function (e, value, row, index) {
            $table.bootstrapTable('remove', {
                field: 'id',
                values: [row.id]
            });
        }
    };
    function operateFormatter(value, row, index) {
        return [
            '<a class="redact" href="javascript:editData('+value+');" title="点击编辑">',
            '<i class="glyphicon glyphicon-pencil"></i>',
            '</a>  ',
            '<a class="remove" href="javascript:delete_btn_event('+value+');" title="点击删除">',
            '<i class="glyphicon glyphicon glyphicon-trash"></i>',
            '</a>'
        ].join('');
    }
    //表格中删除按钮事件
    function delete_btn_event(td_obj){
    	var ids =[];
    	ids[0] = td_obj;
    	$.ajax({
    		url:'/web/merchantinfo/delete',
    		type:'POST',
    		dataType : "json",
    		data:{'ids':ids},
    		success:function(data){
    			console.log();
    			if(data.success)
    			{
    				alert('删除成功');
    				queryEvent();
    			}else
    			{
    				alert('删除失败');
    			}	
    		},
    		error:function(e)
    		{
    			alert('系统异常!'+e);
    		}
    	});
    }
    //表格中编辑事件
    function editData(id)
    {
    	$.ajax({
    		url:'/web/merchantinfo/queryAllById',
    		type:'POST',
    		dataType : "json",
    		data:{'id':id},
    		success:function(data){
    			//data.data就是所有数据集
    			console.log(data.data);
    		}
    	});
    }
    //初始化表格
    function initTableData(){
    	$('#table').bootstrapTable({
            sidePagination:'server',
            search: false, //是否启动搜索栏 
            url:'/web/merchantinfo/query',
            showRefresh: true,//是否显示刷新按钮
            showPaginationSwitch: false,//是否显示 数据条数选择框(分页是否显示)
            toolbar: '#toolbar',  //工具按钮用哪个容器
            striped: true,   //是否显示行间隔色
            cache: false,   //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            pagination: true,   //是否显示分页（*）
            sortable: true,   //是否启用排序
            sortOrder: "asc",   //排序方式
            pageNumber:1,   //初始化加载第一页，默认第一页
            pageSize: 15,   //每页的记录行数（*）
            pageList: [15, 20, 50, 100], //可供选择的每页的行数（*）
            queryParams:queryParams,
            responseHandler:responseHandler,//处理服务器返回数据
            columns: [{
                field: 'state',
                checkbox: true,
                rowspan:1,
                align: 'center',
                valign: 'middle'
            },{
                field: 'id',
                title: '操作',
                width:'10%',
                align: 'center',
                formatter: operateFormatter
                // events: operateEvents
            },{
                field: 'merName',
                title: '商户名'
            }, {
                field: 'innerCode',
                title: '内部商户号'
            }, {
                field: 'legalPerson',
                title: '商户法人姓名'
            }, {
                field: 'legalPersonTel',
                title: '法人联系电话'
            }, {
                field: 'legalValidCardType',
                title: '法人有效证件类型'
            }, {
                field: 'cardNum',
                title: '证件号码'
            }, {
                field: 'cardValidTime',
                title: '证件有效期'
            }, {
                field: 'businessLicenseNum',
                title: '营业执照号码'
            }, {
                field: 'businessLicenseValidTime',
                title: '营业执照有效期'
            }, {
                field: 'taxRegistCode',
                title: '税务登记号'
            }, {
                field: 'registAddress',
                title: '商户注册地址'
            }, {
                field: 'mercFlag',
                title: '商户标签'
            }, {
                field: 'source',
                title: '商户注册来源',
                formatter:formatSource
            }]
        });
    }
    
    //商户注册来源格式处理
    function formatSource(value, row, index){
    	if(value == '1')
    	{
    		return 'APP';
    	}else if(value == '0')
    	{
    		return 'WEB';
    	}else{
    		return '其他';
    	}	
    }
    
   //组装请求参数
   function queryParams(params)
   {
	   var param ={
			   currentPageNum : this.pageNumber,
			   pageSize : this.pageSize,
			   merName :$('#txt_search_id').val(),
			   legalPerson:$('#txt_search_name').val(),
			   legalPersonMobile:$('#txt_search_price').val()
	   }
	   return param;
   }
   //处理后台返回数据
   function responseHandler(res) { 
	    if (res) {
	        return {
	            "rows" : res.list,
	            "total" : res.total
	        };
	    } else {
	        return {
	            "rows" : [],
	            "total" : 0
	        };
	    }
	}
   //条件查询按钮事件
   function queryEvent(){
	   $('#table').bootstrapTable('refresh');
   }
   //重置按钮事件
   function resetEvent(){
	   $('#formSearch')[0].reset();
   }
   
   getInnerCode();
   $('#btn_add').click(function(){
	   var  objs=document.getElementsByName("init");
	   for(var i= 0;i<objs.length;i++){
		   objs[i].click();
	   }
   });
  
   function  fileUp(num){
	   var inno_code = $('#innoCode').val();
	   if(!inno_code)inno_code=getInnerCode();
	 //文件上传
	   $('#uploadify_file'+num).uploadify({
		   //指定swf文件
	       'swf': 'js/uploadify-v3.1/uploadify.swf',
	       //指定显示的id
	       'queueID' : 'fileQueue'+num,
	       //后台处理的页面
	       'uploader': '/web/fileInfo/Import', 
	       //按钮显示的文字
	       'buttonText': '上传图片',
	     //在浏览窗口底部的文件类型下拉菜单中显示的文本
	       'fileTypeDesc': 'Image Files',
	     //允许上传的文件后缀
	       'fileTypeExts': '*.gif; *.jpg; *.png',
	       'auto': true,
	       'multi': true,
	       //参数
	       'formData': {
	           'fileTypeKey':num,"innerCode":inno_code
	       },
	       'onUploadSuccess':function ( file, response, data) {
	    	   	var obj = eval('(' + response + ')');
				var fileName = file.name.replace(',','');
	       		$('#view'+num).append("<div style='float:left;width:99%'><span class='fileImgName'>"+fileName+"</span>" +
							"<a class='previewfileImg' id='previewfileImg"+obj.id+"' title='预览'><span class='glyphicon glyphicon-zoom-in'></span>预览</a>" +
							"<a title='删除' class='deletefileImg' id='deletefileImg"+obj.id+"' href=javascript:deleteImage('#deletefileImg"+obj.id+"',"+obj.id+",'"+obj.url+"')><span class='glyphicon glyphicon-trash'></span>删除</a><!-- 删除 -->" +
							"</div>");

	    	   	$('#uploadify_file'+num).hide();
	    	   	$('#fileQueue'+num).html('');
	       },
	       'onUploadError': function(file,errorCode,errorMsg,errorString) {
				alert(errorCode+"."+errorMsg+""+errorString);

			}
	   });
   }
   
   //删除图片
   function deleteImage(queueId,id,url)
   {
	   $.ajax({
		   url:'/web/fileInfo/delete',
		   data:{'id':id,'url':url},
		   type:'POST',
		   success:function(data){
			   if(data)
			   {
				   alert('删除成功');
				   $(queueId).parent().parent().parent().next().find('.uploadify').show();
				   $(queueId).parent().parent().html('');
			   }	   
		   }
	   });
   }
   //点击获取innocode
   function getInnerCode()
   {
	   var code = '';
	   if(!$('#innoCode').val()){
		   $.ajax({
			   url:'/web/fileInfo/getInnoCode',
			   type:'POST',
			   success:function(data){
				   $('#innoCode').val(data);
				   code = data;
				   return code;
			   }
		   });
	   }
   }
   //保存表格数据
   $('#save_btn').click(function(){
	   $.ajax({
		   url:'/web/merchantinfo/toAdd',
		   data: $('#merchant_form').serialize(),
		   type:'POST',
		   success:function(data){
			   if(data.success)
			   {
				   alert('保存成功');
				   $('#myModal').hide();
				   queryEvent();
			   }	
			   else{
				   alert('保存失败');
			   }
		   }
	   });
   });
   //批量删除数据
   $('#btn_delete').click(function(){
	   
   });
</script>
</html>
